<mat-grid-list [cols]="12" class="sticky" rowHeight="4rem">
  <!--=================================================Navigation====================================================-->
  <mat-grid-tile [colspan]="12" [rowspan]="1">
    <mat-card class="breadCrumbCard">
      <mat-card-content [innerHTML]="breadcrumb"></mat-card-content>
      @if (enableForm) {
        <div class="form-navigation">
          <div class="form-steps-container">

            <div class="step-item"
                 [ngClass]="{'active': currentSection === 1}"
                 (click)="goToStep(1)">
              <div class="step-circle">1</div>
              <div class="step-label">General Info</div>
            </div>

            <div class="step-connector">
              <div class="connector-line"></div>
            </div>

            <div class="step-item"
                 [ngClass]="{'active': currentSection === 2}"
                 (click)="goToStep(2)">
              <div class="step-circle">2</div>
              <div class="step-label">Discount & Cancel</div>
            </div>

            <div class="step-connector">
              <div class="connector-line"></div>
            </div>

            <div class="step-item"
                 [ngClass]="{'active': currentSection === 3}"
                 (click)="goToStep(3)">
              <div class="step-circle">3</div>
              <div class="step-label">Room Info</div>
            </div>

            <div class="step-connector">
              <div class="connector-line"></div>
            </div>

            <div class="step-item"
                 [ngClass]="{'active': currentSection === 4}"
                 (click)="goToStep(4)">
              <div class="step-circle completed">
                <mat-icon>check</mat-icon>
              </div>
              <div class="step-label">Complete</div>
            </div>
          </div>
        </div>
      }
    </mat-card>
  </mat-grid-tile>
  <!--===============================================================================================================-->
</mat-grid-list>

<mat-grid-list [cols]="12" rowHeight="4rem" gutterSize="20px">

  @if (enableForm) {

    <!--==========================================Accommodation Form Section===========================================-->
    <mat-grid-tile [colspan]="12" [rowspan]="1">
      <mat-card>
        <mat-card-header class="form-header" style="background: unset; border-bottom: unset">
          <mat-card-title class="title">
            <mat-icon style="padding: 5px 20px 0 0">
              <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px"
                   fill="#000000">
                <path
                  d="M40-200v-600h80v400h320v-320h320q66 0 113 47t47 113v360h-80v-120H120v120H40Zm240-240q-50 0-85-35t-35-85q0-50 35-85t85-35q50 0 85 35t35 85q0 50-35 85t-85 35Zm240 40h320v-160q0-33-23.5-56.5T760-640H520v240ZM280-520q17 0 28.5-11.5T320-560q0-17-11.5-28.5T280-600q-17 0-28.5 11.5T240-560q0 17 11.5 28.5T280-520Zm0-40Zm240-80v240-240Z"/>
              </svg>
            </mat-icon>
            Accommodation
          </mat-card-title>
          <div class="form-button-group">
            <button class="goto-records-btn" mat-raised-button (click)="setView('records')"
                    [disabled]="!(enableGoToRecode)">Records
              <mat-icon>list</mat-icon>
            </button>
            <button class="goto-profiles-btn" mat-raised-button (click)="setView('profiles')"
                    [disabled]="!(enableGoToView)">View
              <mat-icon>person</mat-icon>
            </button>
          </div>
        </mat-card-header>
      </mat-card>
    </mat-grid-tile>

    <!--=======================================================General Information=======================================-->

    <mat-grid-tile [colspan]="12" [rowspan]="8" class="step-section" id="step-1">
      <mat-card>
        <mat-card-header class="general-infor-header">
          <mat-card-title class="subtitle">General Information</mat-card-title>
        </mat-card-header>
        <mat-card-content style="overflow:hidden !important;">
          <div class="grid-container">
            <mat-card class="accommodation-detail-card">
              <mat-card-content class="accommodation-main-form">
                <form [formGroup]="accommodationForm">
                  <div class="form-item-container">
                    <div class="form-tem-label-container">
                      <mat-icon>
                        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px"
                             fill="#BB271A">
                          <path
                            d="M400-480q-66 0-113-47t-47-113q0-66 47-113t113-47q66 0 113 47t47 113q0 66-47 113t-113 47ZM80-160v-112q0-33 17-62t47-44q51-26 115-44t141-18h14q6 0 12 2-8 18-13.5 37.5T404-360h-4q-71 0-127.5 18T180-306q-9 5-14.5 14t-5.5 20v32h252q6 21 16 41.5t22 38.5H80Zm560 40-12-60q-12-5-22.5-10.5T584-204l-58 18-40-68 46-40q-2-14-2-26t2-26l-46-40 40-68 58 18q11-8 21.5-13.5T628-460l12-60h80l12 60q12 5 22.5 11t21.5 15l58-20 40 70-46 40q2 12 2 25t-2 25l46 40-40 68-58-18q-11 8-21.5 13.5T732-180l-12 60h-80Zm40-120q33 0 56.5-23.5T760-320q0-33-23.5-56.5T680-400q-33 0-56.5 23.5T600-320q0 33 23.5 56.5T680-240ZM400-560q33 0 56.5-23.5T480-640q0-33-23.5-56.5T400-720q-33 0-56.5 23.5T320-640q0 33 23.5 56.5T400-560Zm0-80Zm12 400Z"/>
                        </svg>
                      </mat-icon>
                      <mat-label>User :</mat-label>
                    </div>
                    <mat-form-field appearance="outline">
                      <mat-label>Select a User</mat-label>
                      <input type="text"
                             matInput
                             formControlName="user"
                             [matAutocomplete]="userAuto">
                      <mat-autocomplete autoActiveFirstOption #userAuto="matAutocomplete"
                                        [displayWith]="displayUserName">
                        @for (user of filteredUserList | async; track user.id) {
                          <mat-option [value]="user">{{ user.employee.callingname }}</mat-option>
                        }
                      </mat-autocomplete>
                      <mat-icon matIconSuffix>verified_user</mat-icon>
                    </mat-form-field>
                  </div>

                  <div class="form-item-container">
                    <div class="form-tem-label-container">
                      <mat-icon>
                        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px"
                             fill="#9B5278">
                          <path
                            d="M200-800v241-1 400-640 200-200Zm80 400h140q9-23 22-43t30-37H280v80Zm0 160h127q-5-20-6.5-40t.5-40H280v80ZM200-80q-33 0-56.5-23.5T120-160v-640q0-33 23.5-56.5T200-880h320l240 240v100q-19-8-39-12.5t-41-6.5v-41H480v-200H200v640h241q16 24 36 44.5T521-80H200Zm460-120q42 0 71-29t29-71q0-42-29-71t-71-29q-42 0-71 29t-29 71q0 42 29 71t71 29ZM864-40 756-148q-21 14-45.5 21t-50.5 7q-75 0-127.5-52.5T480-300q0-75 52.5-127.5T660-480q75 0 127.5 52.5T840-300q0 26-7 50.5T812-204L920-96l-56 56Z"/>
                        </svg>
                      </mat-icon>
                      <mat-label>Reference :</mat-label>
                    </div>
                    <mat-form-field appearance="outline">
                      <mat-label>Enter a Reference</mat-label>
                      <input matInput formControlName="reference">
                    </mat-form-field>
                  </div>

                  <div class="form-item-container">
                    <div class="form-tem-label-container">
                      <mat-icon>
                        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px"
                             fill="#BB271A">
                          <path
                            d="M444-200h70v-50q50-9 86-39t36-89q0-42-24-77t-96-61q-60-20-83-35t-23-41q0-26 18.5-41t53.5-15q32 0 50 15.5t26 38.5l64-26q-11-35-40.5-61T516-710v-50h-70v50q-50 11-78 44t-28 74q0 47 27.5 76t86.5 50q63 23 87.5 41t24.5 47q0 33-23.5 48.5T486-314q-33 0-58.5-20.5T390-396l-66 26q14 48 43.5 77.5T444-252v52Zm36 120q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 83-31.5 156T763-197q-54 54-127 85.5T480-80Zm0-80q134 0 227-93t93-227q0-134-93-227t-227-93q-134 0-227 93t-93 227q0 134 93 227t227 93Zm0-320Z"/>
                        </svg>
                      </mat-icon>
                      <mat-label>Markup :</mat-label>
                    </div>
                    <mat-form-field appearance="outline">
                      <mat-label>Enter a Markup</mat-label>
                      <input matInput formControlName="markup">
                    </mat-form-field>
                  </div>

                  <div class="form-item-container">
                    <div class="form-tem-label-container">
                      <mat-icon>
                        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px"
                             fill="#BD4C31">
                          <path
                            d="M320-400q-17 0-28.5-11.5T280-440q0-17 11.5-28.5T320-480q17 0 28.5 11.5T360-440q0 17-11.5 28.5T320-400Zm160 0q-17 0-28.5-11.5T440-440q0-17 11.5-28.5T480-480q17 0 28.5 11.5T520-440q0 17-11.5 28.5T480-400Zm160 0q-17 0-28.5-11.5T600-440q0-17 11.5-28.5T640-480q17 0 28.5 11.5T680-440q0 17-11.5 28.5T640-400ZM200-80q-33 0-56.5-23.5T120-160v-560q0-33 23.5-56.5T200-800h40v-80h80v80h320v-80h80v80h40q33 0 56.5 23.5T840-720v560q0 33-23.5 56.5T760-80H200Zm0-80h560v-400H200v400Zm0-480h560v-80H200v80Zm0 0v-80 80Z"/>
                        </svg>
                      </mat-icon>
                      <mat-label>Valid Period :</mat-label>
                    </div>
                    <mat-form-field appearance="outline">
                      <mat-label>Select Valid Period</mat-label>
                      <mat-date-range-input
                        [min]="minValidDate"
                        [rangePicker]="validPeriod">
                        <input matStartDate placeholder="Valid From" formControlName="validfrom">
                        <input matEndDate placeholder="Valid To" formControlName="validto">
                      </mat-date-range-input>
                      <mat-datepicker-toggle matIconSuffix [for]="validPeriod"></mat-datepicker-toggle>
                      <mat-date-range-picker #validPeriod></mat-date-range-picker>
                    </mat-form-field>
                  </div>

                  <div class="form-item-container">
                    <div class="form-tem-label-container">
                      <mat-icon>
                        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px"
                             fill="#EA3323">
                          <path
                            d="M440-400h80v-120h120v-80H520v-120h-80v120H320v80h120v120Zm40 214q122-112 181-203.5T720-552q0-109-69.5-178.5T480-800q-101 0-170.5 69.5T240-552q0 71 59 162.5T480-186Zm0 106Q319-217 239.5-334.5T160-552q0-150 96.5-239T480-880q127 0 223.5 89T800-552q0 100-79.5 217.5T480-80Zm0-480Z"/>
                        </svg>
                      </mat-icon>
                      <mat-label>Location :</mat-label>
                    </div>
                    <mat-form-field appearance="outline">
                      <input type="text"
                             matInput
                             formControlName="location"
                             [matAutocomplete]="locationAuto">
                      <mat-autocomplete autoActiveFirstOption #locationAuto="matAutocomplete"
                                        [displayWith]="displayLocationName"
                      >
                        @for (location of filteredAllLocations | async; track location.id) {
                          <mat-option [value]="location">
                            {{ location.name }}
                          </mat-option>
                        }
                      </mat-autocomplete>
                    </mat-form-field>
<!--                    <mat-form-field appearance="outline">-->
<!--                      <mat-label>Enter the Location</mat-label>-->
<!--                      <input matInput formControlName="location">-->
<!--                    </mat-form-field>-->
                  </div>

                  <div class="form-item-container">
                    <div class="form-tem-label-container">
                      <mat-icon>
                        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px"
                             fill="#EA33F7">
                          <path
                            d="M160-120v-480l320-240 320 240v480H160Zm80-80h280v-120H240v120Zm360 0h120v-120H600v120ZM240-400h120v-119H240v119Zm200 0h280v-119H440v119ZM292-599h376L480-740 292-599Z"/>
                        </svg>
                      </mat-icon>
                      <mat-label>Type :</mat-label>
                    </div>
                    <mat-form-field appearance="outline">
                      <mat-label>Select a Type</mat-label>
                      <mat-select formControlName="accommodationtype">
                        <mat-option [value]="null">Not selected</mat-option>
                        @for (type of accommodationTypes; track type.id) {
                          <mat-option [value]="type">{{ type.name }}</mat-option>
                        }
                      </mat-select>
                    </mat-form-field>
                  </div>

                  <div class="form-item-container">
                    <div class="form-tem-label-container">
                      <mat-icon>
                        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px"
                             fill="#00a339">
                          <path
                            d="m424-296 282-282-56-56-226 226-114-114-56 56 170 170Zm56 216q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 83-31.5 156T763-197q-54 54-127 85.5T480-80Zm0-80q134 0 227-93t93-227q0-134-93-227t-227-93q-134 0-227 93t-93 227q0 134 93 227t227 93Zm0-320Z"/>
                        </svg>
                      </mat-icon>
                      <mat-label>Status :</mat-label>
                    </div>
                    <mat-form-field appearance="outline">
                      <mat-label>Select a Status</mat-label>
                      <mat-select formControlName="accommodationstatus">
                        <mat-option [value]="null">Not selected</mat-option>
                        @for (status of accommodationStatus; track status.id) {
                          <mat-option [value]="status">{{ status.name }}</mat-option>
                        }
                      </mat-select>
                    </mat-form-field>
                  </div>
                </form>
              </mat-card-content>
            </mat-card>

            <mat-card class="accommodation-detail-card">
              <mat-card-content class="accommodation-main-form">
                <form [formGroup]="accommodationForm">
                  <div class="form-item-container">
                    <div class="form-tem-label-container">
                      <mat-icon>
                        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px"
                             fill="#A96424">
                          <path
                            d="M720-400v-120H600v-80h120v-120h80v120h120v80H800v120h-80Zm-360-80q-66 0-113-47t-47-113q0-66 47-113t113-47q66 0 113 47t47 113q0 66-47 113t-113 47ZM40-160v-112q0-34 17.5-62.5T104-378q62-31 126-46.5T360-440q66 0 130 15.5T616-378q29 15 46.5 43.5T680-272v112H40Zm80-80h480v-32q0-11-5.5-20T580-306q-54-27-109-40.5T360-360q-56 0-111 13.5T140-306q-9 5-14.5 14t-5.5 20v32Zm240-320q33 0 56.5-23.5T440-640q0-33-23.5-56.5T360-720q-33 0-56.5 23.5T280-640q0 33 23.5 56.5T360-560Zm0-80Zm0 400Z"/>
                        </svg>
                      </mat-icon>
                      <mat-label>Supplier :</mat-label>
                    </div>

                    <mat-form-field appearance="outline">
                      <mat-label>Select a Supplier</mat-label>
                      <input type="text"
                             matInput
                             formControlName="supplier"
                             [matAutocomplete]="supplierAuto">
                      <mat-autocomplete autoActiveFirstOption #supplierAuto="matAutocomplete"
                                        [displayWith]="displaySupplierName"
                      >
                        @for (supplier of filteredSupplierList | async; track supplier.id) {
                          <mat-option [value]="supplier"
                                      (onSelectionChange)="generateAccommReference()">{{ supplier.brno + " - " + supplier.name }}
                          </mat-option>
                        }
                      </mat-autocomplete>
                    </mat-form-field>
                  </div>

                  <div class="form-item-container">
                    <div class="form-tem-label-container">
                      <mat-icon>
                        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px"
                             fill="#8C1AF6">
                          <path
                            d="M280-240h40v-60h320v60h40v-160q0-33-23.5-56.5T600-480H460v140H320v-180h-40v280Zm110-120q21 0 35.5-14.5T440-410q0-21-14.5-35.5T390-460q-21 0-35.5 14.5T340-410q0 21 14.5 35.5T390-360ZM160-120v-480l320-240 320 240v480H160Zm80-80h480v-360L480-740 240-560v360Zm240-270Z"/>
                        </svg>
                      </mat-icon>
                      <mat-label>Accomm :</mat-label>
                    </div>
                    <mat-form-field appearance="outline">
                      <mat-label>Enter a Accommodation</mat-label>
                      <input matInput formControlName="name">
                    </mat-form-field>
                  </div>

                  <div class="form-item-container">
                    <div class="form-tem-label-container">
                      <mat-icon>
                        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px"
                             fill="#EA3323">
                          <path
                            d="M560-440q-50 0-85-35t-35-85q0-50 35-85t85-35q50 0 85 35t35 85q0 50-35 85t-85 35ZM280-320q-33 0-56.5-23.5T200-400v-320q0-33 23.5-56.5T280-800h560q33 0 56.5 23.5T920-720v320q0 33-23.5 56.5T840-320H280Zm80-80h400q0-33 23.5-56.5T840-480v-160q-33 0-56.5-23.5T760-720H360q0 33-23.5 56.5T280-640v160q33 0 56.5 23.5T360-400Zm440 240H120q-33 0-56.5-23.5T40-240v-440h80v440h680v80ZM280-400v-320 320Z"/>
                        </svg>
                      </mat-icon>
                      <mat-label>Currency :</mat-label>
                    </div>
                    <mat-form-field appearance="outline">
                      <mat-label>Select a Currency</mat-label>
                      <mat-select formControlName="currency">
                        <mat-option [value]="null">Not selected</mat-option>
                        @for (currency of currencies; track currency.id) {
                          <mat-option [value]="currency">{{ currency.name }}</mat-option>
                        }
                      </mat-select>
                    </mat-form-field>
                  </div>

                  <div class="form-item-container">
                    <div class="form-tem-label-container">
                      <mat-icon>
                        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px"
                             fill="#F19E39">
                          <path
                            d="M320-400q-17 0-28.5-11.5T280-440q0-17 11.5-28.5T320-480q17 0 28.5 11.5T360-440q0 17-11.5 28.5T320-400Zm160 0q-17 0-28.5-11.5T440-440q0-17 11.5-28.5T480-480q17 0 28.5 11.5T520-440q0 17-11.5 28.5T480-400Zm160 0q-17 0-28.5-11.5T600-440q0-17 11.5-28.5T640-480q17 0 28.5 11.5T680-440q0 17-11.5 28.5T640-400ZM200-80q-33 0-56.5-23.5T120-160v-560q0-33 23.5-56.5T200-800h40v-80h80v80h320v-80h80v80h40q33 0 56.5 23.5T840-720v560q0 33-23.5 56.5T760-80H200Zm0-80h560v-400H200v400Zm0-480h560v-80H200v80Zm0 0v-80 80Z"/>
                        </svg>
                      </mat-icon>
                      <mat-label>Sales Period :</mat-label>
                    </div>
                    <mat-form-field appearance="outline">
                      <mat-label>Select Sales Period</mat-label>
                      <mat-date-range-input
                        [min]="minSaleDate"
                        [max]="maxSaleDate"
                        [rangePicker]="salesPeriod">
                        <input matStartDate placeholder="Sales From" formControlName="salesfrom">
                        <input matEndDate placeholder="Sales To" formControlName="salesto">
                      </mat-date-range-input>
                      <mat-datepicker-toggle matIconSuffix [for]="salesPeriod"></mat-datepicker-toggle>
                      <mat-date-range-picker #salesPeriod></mat-date-range-picker>
                    </mat-form-field>
                  </div>

                  <div class="form-item-container">
                    <div class="form-tem-label-container">
                      <mat-icon>
                        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px"
                             fill="#0000F5">
                          <path
                            d="M500-482q29-32 44.5-73t15.5-85q0-44-15.5-85T500-798q60 8 100 53t40 105q0 60-40 105t-100 53Zm220 322v-120q0-36-16-68.5T662-406q51 18 94.5 46.5T800-280v120h-80Zm80-280v-80h-80v-80h80v-80h80v80h80v80h-80v80h-80Zm-480-40q-66 0-113-47t-47-113q0-66 47-113t113-47q66 0 113 47t47 113q0 66-47 113t-113 47ZM0-160v-112q0-34 17.5-62.5T64-378q62-31 126-46.5T320-440q66 0 130 15.5T576-378q29 15 46.5 43.5T640-272v112H0Zm320-400q33 0 56.5-23.5T400-640q0-33-23.5-56.5T320-720q-33 0-56.5 23.5T240-640q0 33 23.5 56.5T320-560ZM80-240h480v-32q0-11-5.5-20T540-306q-54-27-109-40.5T320-360q-56 0-111 13.5T100-306q-9 5-14.5 14T80-272v32Zm240-400Zm0 400Z"/>
                        </svg>
                      </mat-icon>
                      <mat-label>Residents :</mat-label>
                    </div>
                    <mat-form-field appearance="outline">
                      <mat-label>Select a Resident</mat-label>
                      <mat-select formControlName="residenttype">
                        <mat-option [value]="null">Not selected</mat-option>
                        @for (resident of residentTypes; track resident.id) {
                          <mat-option [value]="resident">{{ resident.name }}</mat-option>
                        }
                      </mat-select>
                    </mat-form-field>
                  </div>

                  <div class="form-item-container">
                    <div class="form-tem-label-container">
                      <mat-icon>
                        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px"
                             fill="#EAC452">
                          <path
                            d="m668-380 152-130 120 10-176 153 52 227-102-62-46-198Zm-94-292-42-98 46-110 92 217-96-9ZM294-287l126-76 126 77-33-144 111-96-146-13-58-136-58 135-146 13 111 97-33 143ZM173-120l65-281L20-590l288-25 112-265 112 265 288 25-218 189 65 281-247-149-247 149Zm247-340Z"/>
                        </svg>
                      </mat-icon>
                      <mat-label>Rate :</mat-label>
                    </div>
                    <mat-form-field appearance="outline">
                      <mat-label>Select a Rate</mat-label>
                      <mat-select formControlName="starrating">
                        <mat-option [value]="null">Not selected</mat-option>
                        @for (rate of accommodationStarRates; track rate.id) {
                          <mat-option [value]="rate">{{ rate.name }}</mat-option>
                        }
                      </mat-select>
                    </mat-form-field>
                  </div>
                </form>
              </mat-card-content>
            </mat-card>
          </div>
        </mat-card-content>
      </mat-card>
    </mat-grid-tile>


    <!--==============================================Discount and Cancellations=========================================-->

    <mat-grid-tile [colspan]="12" [rowspan]="6" class="step-section" id="step-2">
      <mat-card>
        <mat-card-header>
          <mat-card-title class="subtitle">Discounts & Cancellation Charges</mat-card-title>
        </mat-card-header>
        <mat-card-content class="accommodation-form">
          <div class="grid-container">
            <mat-card class="accommodation-detail-card">
              <mat-card-header class="custom-header discount-header">
                <mat-card-title class="subtitle">Discounts</mat-card-title>
                <div class="discount-type-btn-container">
                  <button class="data-add-btn" mat-raised-button (click)="addDiscount()">
                    <mat-icon>add</mat-icon>
                    Add
                  </button>
                  <button class="data-clear-btn" mat-raised-button (click)="clearDiscount()">
                    <mat-icon>clear</mat-icon>
                    Clear
                  </button>
                </div>
              </mat-card-header>

              <mat-card-content>
                <form [formGroup]="accommodationDiscountForm" style="padding-top: 5px">
                  <div class="form-item-container">
                    <div class="form-tem-label-container">
                      <mat-icon>
                        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px"
                             fill="#EA3323">
                          <path
                            d="M80-160v-640h800v640H80Zm80-80h640v-480H160v480Zm0 0v-480 480Zm160-40h80v-40h40q17 0 28.5-11.5T480-360v-120q0-17-11.5-28.5T440-520H320v-40h160v-80h-80v-40h-80v40h-40q-17 0-28.5 11.5T240-600v120q0 17 11.5 28.5T280-440h120v40H240v80h80v40Zm320-30 80-80H560l80 80Zm-80-250h160l-80-80-80 80Z"/>
                        </svg>
                      </mat-icon>
                      <mat-label>Discount :</mat-label>
                    </div>
                    <mat-form-field appearance="outline">
                      <mat-label>Select a Discount Type</mat-label>
                      <mat-select formControlName="accommodationdiscounttype">
                        <mat-option [value]="null">Not selected</mat-option>
                        @for (
                          accommodationDiscountType of accommodationDiscountTypes; track accommodationDiscountType.id) {
                          <mat-option [value]="accommodationDiscountType">{{ accommodationDiscountType.name }}
                          </mat-option>
                        }
                      </mat-select>
                    </mat-form-field>
                  </div>

                  <div class="form-item-container">
                    <div class="form-tem-label-container">
                      <mat-icon>
                        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px"
                             fill="#00a339">
                          <path
                            d="M440-200h80v-40h40q17 0 28.5-11.5T600-280v-120q0-17-11.5-28.5T560-440H440v-40h160v-80h-80v-40h-80v40h-40q-17 0-28.5 11.5T360-520v120q0 17 11.5 28.5T400-360h120v40H360v80h80v40ZM240-80q-33 0-56.5-23.5T160-160v-640q0-33 23.5-56.5T240-880h320l240 240v480q0 33-23.5 56.5T720-80H240Zm280-560v-160H240v640h480v-480H520ZM240-800v160-160 640-640Z"/>
                        </svg>
                      </mat-icon>
                      <mat-label>Amount :</mat-label>
                    </div>
                    <mat-form-field appearance="outline">
                      <mat-label>Enter Amount</mat-label>
                      <input matInput formControlName="amount">
                    </mat-form-field>
                  </div>
                </form>

                <form [formGroup]="accommodationForm">
                  <av-data-table
                    [TableHeaders]="discountTableHeaders"
                    [TableColumns]="discountTableColumns"
                    [EnableActionColumn]="true"
                    [EnableButtonDelete]="true"
                    [Data]="accommodationDiscounts"
                    formControlName="accommodationdiscounts"
                  >
                  </av-data-table>
                </form>

              </mat-card-content>
            </mat-card>

            <mat-card class="accommodation-detail-card"
                      style="max-width: 700px !important; min-width: 500px !important;">
              <mat-card-header class="custom-header cancellation-header">
                <mat-card-title class="subtitle">Cancellation</mat-card-title>
                <div class="cancellation-type-btn-container">
                  <button class="data-add-btn" mat-raised-button (click)="addCancellationCharge()">
                    <mat-icon>add</mat-icon>
                    Add
                  </button>
                  <button class="data-clear-btn" mat-raised-button (click)="clearCancellationCharge()">
                    <mat-icon>clear</mat-icon>
                    Clear
                  </button>
                </div>
              </mat-card-header>

              <mat-card-content>
                <form [formGroup]="accommodationCancellationChargesForm" style="padding-top: 5px">
                  <div class="form-item-container">
                    <div class="form-tem-label-container">
                      <mat-icon>
                        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px"
                             fill="#992B15">
                          <path
                            d="m136-240-56-56 296-298 160 160 208-206H640v-80h240v240h-80v-104L536-320 376-480 136-240Z"/>
                        </svg>
                      </mat-icon>
                      <mat-label>Rate Type :</mat-label>
                    </div>
                    <mat-form-field appearance="outline">
                      <mat-label>Select a Rate Type</mat-label>
                      <mat-select formControlName="ratetype">
                        <mat-option [value]="null">Not selected</mat-option>
                        @for (rateType of rateTypes; track rateType.id) {
                          <mat-option [value]="rateType">{{ rateType.name }}</mat-option>
                        }
                      </mat-select>
                    </mat-form-field>
                  </div>

                  <div class="form-item-container">
                    <div class="form-tem-label-container">
                      <mat-icon>
                        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px"
                             fill="#B89230">
                          <path
                            d="M160-40v-240h100v-80H160v-240h100v-80H160v-240h280v240H340v80h100v80h120v-80h280v240H560v-80H440v80H340v80h100v240H160Zm80-80h120v-80H240v80Zm0-320h120v-80H240v80Zm400 0h120v-80H640v80ZM240-760h120v-80H240v80Zm60-40Zm0 320Zm400 0ZM300-160Z"/>
                        </svg>
                      </mat-icon>
                      <mat-label>Scheme :</mat-label>
                    </div>
                    <mat-form-field appearance="outline">
                      <mat-label>Select a Cancellation Scheme</mat-label>
                      <mat-select formControlName="cancellationscheme">
                        <mat-option [value]="null">Not selected</mat-option>
                        @for (cancellationScheme of cancellationSchemes; track cancellationScheme.id) {
                          <mat-option [value]="cancellationScheme">{{ cancellationScheme.name }}</mat-option>
                        }
                      </mat-select>
                    </mat-form-field>
                  </div>

                  <div class="form-item-container">
                    <div class="form-tem-label-container">
                      <mat-icon>
                        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px"
                             fill="#00a339">
                          <path
                            d="M440-200h80v-40h40q17 0 28.5-11.5T600-280v-120q0-17-11.5-28.5T560-440H440v-40h160v-80h-80v-40h-80v40h-40q-17 0-28.5 11.5T360-520v120q0 17 11.5 28.5T400-360h120v40H360v80h80v40ZM240-80q-33 0-56.5-23.5T160-160v-640q0-33 23.5-56.5T240-880h320l240 240v480q0 33-23.5 56.5T720-80H240Zm280-560v-160H240v640h480v-480H520ZM240-800v160-160 640-640Z"/>
                        </svg>
                      </mat-icon>
                      <mat-label>Amount :</mat-label>
                    </div>
                    <mat-form-field appearance="outline">
                      <mat-label>Enter Amount</mat-label>
                      <input matInput formControlName="amount">
                    </mat-form-field>
                  </div>
                </form>

                <form [formGroup]="accommodationForm">
                  <av-data-table
                    [TableHeaders]="cancellationTableHeaders"
                    [TableColumns]="cancellationTableColumns"
                    [EnableActionColumn]="true"
                    [EnableButtonDelete]="true"
                    [Data]="accommodationCancellationCharges"
                    formControlName="accommodationcncelationcharges"
                  >
                  </av-data-table>
                </form>
              </mat-card-content>
            </mat-card>
          </div>
        </mat-card-content>
      </mat-card>
    </mat-grid-tile>

    <!--===========================================================Rooms=================================================-->

    <mat-grid-tile [colspan]="12" [rowspan]="12" class="step-section" id="step-3">
      <mat-card>
        <mat-card-header class="custom-header">
          <mat-card-title class="subtitle">Rooms</mat-card-title>
          <div class="room-adding-navigation">
            <div class="nav-item roomType">
              <div class="circle-indicator">1</div>
              <span>Room Type</span>
            </div>
            <div class="nav-connector-line"></div>
            <div class="nav-item facilities">
              <div class="circle-indicator">2</div>
              <span>Facilities</span>
            </div>
            <div class="nav-connector-line"></div>
            <div class="nav-item occupancy">
              <div class="circle-indicator">3</div>
              <span>Occupancies & Rates</span>
            </div>
            <div class="nav-connector-line"></div>
          </div>
          <div id="createRoom" class="room-btn-container">
            <button mat-raised-button
                    [disabled]="!isEnableCreateRoom"
                    (click)="addRoomToAccommodation()">
              <mat-icon>add</mat-icon>
              Create Room
            </button>
          </div>
        </mat-card-header>
        <mat-card-content class="accommodation-form">

          <div class="grid-container">
            <mat-card class="accommodation-detail-card">
              <mat-card-header class="custom-header room-type-header">
                <mat-card-title>Room Type</mat-card-title>
                <div class="room-btn-container">
                  <button class="data-add-btn" mat-raised-button (click)="addRooms()"
                          [disabled]="!isEnableRoomAdd"
                  >
                    <mat-icon>add</mat-icon>
                    Add
                  </button>
                  <button class="data-clear-btn" mat-raised-button (click)="clearRoom()"
                          [disabled]="!isEnableRoomAdd">
                    <mat-icon>clear</mat-icon>
                    Clear
                  </button>
                </div>
              </mat-card-header>
              <mat-card-content>
                <form [formGroup]="accommodationRoomForm" style="padding-top: 5px">
                  <div class="form-item-container">
                    <div class="form-tem-label-container">
                      <mat-icon>
                        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px"
                             fill="#D16D6A">
                          <path
                            d="M160-120v-480l320-240 320 240v480H160Zm80-80h280v-120H240v120Zm360 0h120v-120H600v120ZM240-400h120v-119H240v119Zm200 0h280v-119H440v119ZM292-599h376L480-740 292-599Z"/>
                        </svg>
                      </mat-icon>
                      <mat-label>Room Type :</mat-label>
                    </div>
                    <mat-form-field appearance="outline">
                      <mat-label>Select a Room Type</mat-label>
                      <mat-select formControlName="roomtype">
                        <mat-option [value]="null">Not selected</mat-option>
                        @for (roomType of roomTypes; track roomType.id) {
                          <mat-option [value]="roomType">{{ roomType.name }}</mat-option>
                        }
                      </mat-select>
                    </mat-form-field>
                  </div>

                  <div class="form-item-container">
                    <div class="form-tem-label-container">
                      <mat-icon>
                        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px"
                             fill="#B89230">
                          <path
                            d="M440-280h80v-160h160v-80H520v-160h-80v160H280v80h160v160Zm40 200q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 83-31.5 156T763-197q-54 54-127 85.5T480-80Zm0-80q134 0 227-93t93-227q0-134-93-227t-227-93q-134 0-227 93t-93 227q0 134 93 227t227 93Zm0-320Z"/>
                        </svg>
                      </mat-icon>
                      <mat-label>Room Count :</mat-label>
                    </div>
                    <mat-form-field appearance="outline">
                      <mat-label>Enter a Room Count</mat-label>
                      <input type="number" min="0" matInput formControlName="rooms">
                    </mat-form-field>
                  </div>

                </form>
              </mat-card-content>
            </mat-card>
            <mat-card class="accommodation-detail-card"
                      style="max-width: 700px !important; min-width: 500px !important;">
              <mat-card-header class="custom-header room-facility-header">
                <mat-card-title>Facilities</mat-card-title>
                <div class="room-btn-container">
                  <button class="data-add-btn" mat-raised-button (click)="addAccommodationRoomFacilities()"
                          [disabled]="!isEnableRoomFacilityAdd">
                    <mat-icon>add</mat-icon>
                    Add
                  </button>
                  <button class="data-clear-btn" mat-raised-button (click)="clearAccommodationRoomFacilities()"
                          [disabled]="!isEnableRoomFacilityAdd">
                    <mat-icon>clear</mat-icon>
                    Clear
                  </button>
                </div>
              </mat-card-header>
              <mat-card-content class="room-facilities-container">

                <form [formGroup]="accommodationFacilityForm" class="facilities-form">
                  <div class="facilities-container">
                    <mat-form-field class="search-field" appearance="outline" style="width: 100%">
                      <mat-label>Search facilities...</mat-label>
                      <input matInput formControlName="filterField" (keyup)="filterFacilities()"
                             placeholder="Search facilities...">
                    </mat-form-field>

                    <div class="selected-facilities-section">
                      <h3>Selected Facilities</h3>
                      <div class="chip-container">
                        <mat-chip-set>
                          @for (facility of selectedFacilities; track $index) {
                            <mat-chip style="color: white;"
                                      class="selected-facility"
                                      highlighted
                                      color="primary">
                              {{ facility.name }}
                              <button style="background: none !important; border: none !important;" matChipRemove
                                      (click)="removeFacility(facility)">
                                <mat-icon>cancel</mat-icon>
                              </button>
                            </mat-chip>
                          }
                        </mat-chip-set>
                      </div>
                    </div>
                  </div>
                </form>
              </mat-card-content>
            </mat-card>
          </div>

          <!--=======================================================================================================-->
          <mat-card class="accommodation-detail-card" style="height: fit-content !important;">
            <mat-card-content style="height: fit-content !important;">
              <!-- All Facilities section -->
              <div class="all-facilities-section">
                <h3>All Facilities</h3>
                <div class="chip-container">
                  <mat-chip-set>
                    @for (facility of filteredFacilities; track $index) {
                      <mat-chip
                        class="available-facility"
                        (click)="selectFacility(facility)">
                        {{ facility.name }}
                      </mat-chip>
                    }
                  </mat-chip-set>
                </div>
              </div>
            </mat-card-content>
          </mat-card>

          <!--========================================Created Room Table(Temporary)==================================-->
          <form [formGroup]="accommodationRoomForm">
            @if (tempAccommRooms.length > 0) {
              <mat-card class="accommodation-detail-card">
                <mat-card-content>
                  <div class="room-header-row">
                    <strong class="type">Type</strong>
                    <strong class="room">Rooms</strong>
                    <strong class="action">Action</strong>
                  </div>
                  @for (room of tempAccommRooms; track room.id; let i = $index) {
                    <mat-card>
                      <mat-card-content>
                        <div class="room-item-details">
                          <div class="room-item-row">
                            <span class="room-type">{{ room.roomtype.name }}</span>
                            <span class="room-amount">{{ room.rooms }}</span>
                            <button class="room-action" mat-icon-button color="warn" (click)="removeRoom(i)">
                              <mat-icon style="color:#ffffff;">delete</mat-icon>
                            </button>
                            @if (room.accommodationfacilities && room.accommodationfacilities.length > 0) {
                              <div class="added-facility-container">
                                <div class="facilities-list">
                                  <div>Facilities</div>
                                  <div>
                                    @for (facility of room.accommodationfacilities; track $index) {
                                      <mat-chip style="color: white;"
                                                class="selected-facility"
                                                highlighted
                                                color="primary">
                                        {{ facility.roomfacilities.name }}
                                        <button style="background: none !important; border: none !important;"
                                                matChipRemove
                                                (click)="removeAddedFacility(room, facility)">
                                          <mat-icon>cancel</mat-icon>
                                        </button>
                                      </mat-chip>
                                    }
                                  </div>
                                </div>
                              </div>
                            }
                          </div>
                        </div>
                      </mat-card-content>
                    </mat-card>
                  }
                </mat-card-content>
              </mat-card>
            }
          </form>
          <!--=======================================================================================================-->

          <!--========================================Occupancy Pax and Rates========================================-->
          <mat-card class="accommodation-detail-card" style="margin-top: 20px; height: fit-content !important;">
            <mat-card-header class="room-occupancy-header">
              <mat-card-title>Occupancies Pax & Rates</mat-card-title>
              @if (isEnableCreateRoom) {
                <div class="go-to-create-room blink" (click)="goToCreatRoom()">
                  Go to Create Room
                  <span><mat-icon>arrow_upward</mat-icon></span>
                </div>
              }
            </mat-card-header>
            <mat-card-content class="pax-form-main-container">
              <form [formGroup]="accommodationOccupanciesPaxAndRateForm">
                <div class="pax-form-container">
                  <div class="pax-types-row">
                    @for (paxType of paxTypes; track paxType.id; let i = $index) {
                      <ng-container>
                        <div class="pax-type-column">
                          <div class="pax-type-name">{{ paxType.name }}</div>

                          <div class="pax-count-container">
                            <mat-form-field appearance="outline">
                              <mat-icon style="color: black" matIconPrefix class="count-button-decrement"
                                        [ngClass]="{'do-not' : getCount(paxType) === 0}"
                                        (click)="decrementCount(paxType)">remove
                              </mat-icon>
                              <input readonly matInput [value]="getCount(paxType)" formControlName="count">
                              <mat-icon style="color: black" matIconSuffix class="count-button-increment"
                                        (click)="incrementCount(paxType)">add
                              </mat-icon>
                            </mat-form-field>
                          </div>

                          <mat-form-field appearance="outline" class="amount-field">
                            <mat-label>Amount for a Pax</mat-label>
                            <input matInput type="number" [min]="0" formControlName="amount">
                          </mat-form-field>

                          <button mat-raised-button class="add-occupancy-pax-btn" (click)="addOccupancyPax(paxType)"
                                  [disabled]="!isEnableOccupancyPaxAndRateAdd"
                          >
                            <mat-icon>add</mat-icon>
                            Add
                          </button>
                        </div>
                      </ng-container>
                    }
                  </div>
                </div>
                <!--=================================================================================================-->

                <!--=============================Created Occupancy Table(Temporary)==================================-->

                @if (accommodationOccupanciesPax.length > 0 && accommodationRates.length > 0) {
                  <div class="accomm-occupancy-rate-item-header-row">
                    <strong class="paxtype">Pax Type</strong>
                    <strong class="amount">Amount for one Pax</strong>
                    <strong class="count">Count</strong>
                    <strong class="action">Action</strong>
                  </div>

                  @for (occupanciesPax of accommodationOccupanciesPax; track occupanciesPax.id; let i = $index) {
                    <mat-card>
                      <mat-card-content>
                        <div class="accomm-occupancy-rate-item-details">
                          <div class="accomm-occupancy-rate-item-row">
                          <span
                            class="accomm-occupancy-rate-pax-type">{{ accommodationOccupanciesPax[i].paxtype.name }}</span>
                            <!-- Get corresponding rate based on index -->
                            <span
                              class="accomm-occupancy-rate-amount">{{ accommodationRates[i].amount }}</span>
                            <span
                              class="accomm-occupancy-rate-count">{{ accommodationOccupanciesPax[i].count }}</span>

                            <button class="accomm-occupancy-rate-action" mat-icon-button color="warn"
                                    (click)="removeAccommodationOccupancy(i)">
                              <mat-icon style="color:#ffffff;">delete</mat-icon>
                            </button>
                          </div>
                        </div>
                      </mat-card-content>
                    </mat-card>
                  }
                }
              </form>
              <!--===================================================================================================-->
            </mat-card-content>
          </mat-card>
        </mat-card-content>
      </mat-card>
    </mat-grid-tile>

    @if (accommRoomData && isEnableRoomView) {
      <!--===============================Created and Stored Accomm Room Details Table==================================-->
      <mat-grid-tile [colspan]="12" [rowspan]="accommodationRooms.length + 1" class="accomm-room-table">
        <mat-card>
          <mat-card-content>
            <mat-table [dataSource]="accommRoomData" class="mat-elevation-z8">
              <!-- Room Type Column -->
              <ng-container matColumnDef="roomType">
                <mat-header-cell *matHeaderCellDef>Room Type</mat-header-cell>
                <mat-cell *matCellDef="let element">{{ element.roomtype?.name }}</mat-cell>
              </ng-container>

              <ng-container matColumnDef="rooms">
                <mat-header-cell *matHeaderCellDef>Rooms</mat-header-cell>
                <mat-cell *matCellDef="let element">{{ element.rooms }}</mat-cell>
              </ng-container>

              <ng-container matColumnDef="actions">
                <mat-header-cell *matHeaderCellDef>Actions</mat-header-cell>
                <mat-cell *matCellDef="let element">
                  <div class="tbl-btn-container">
                    <button mat-icon-button class="modify-btn" (click)="editSelectedRoom(element)">
                      <mat-icon>border_color</mat-icon>
                    </button>
                    <button mat-icon-button class="delete-btn" (click)="deleteSelectedRoom(element)">
                      <mat-icon>delete_forever</mat-icon>
                    </button>
                  </div>
                </mat-cell>
              </ng-container>

              <!-- Define header and row -->
              <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>
              <mat-row *matRowDef="let row; columns: displayedColumns;"
                       [ngClass]="{'selected-row': row === selectedRoomRow}">
              </mat-row>
            </mat-table>
          </mat-card-content>
        </mat-card>

      </mat-grid-tile>
    }

    <!--===============================================Control Buttons===========================================================-->
    <mat-grid-tile class="control-button-container" [colspan]="12" [rowspan]="1">
      <mat-card class="accommodation-detail-card">
        <mat-card-footer class="step-section" id="step-4">
          <div class="control-button-panel">
            <button class="control-add-btn" mat-raised-button (click)="save()"
                    [disabled]="!(enableAdd && hasInsertAuthority)">Add
            </button>
            <button class="control-clear-btn" mat-raised-button (click)="clear()">Clear</button>
            <button class="control-update-btn" mat-raised-button (click)="update()"
                    [disabled]="!(enableUpdate && hasUpdateAuthority)">Update
            </button>
            <button class="control-delete-btn" mat-raised-button
                    [disabled]="!(enableDelete && hasDeleteAuthority)" (click)="delete()">Delete
            </button>
          </div>
        </mat-card-footer>
      </mat-card>
    </mat-grid-tile>
    <!--=============================================================================================================-->
  }


  <!--===========================================Accommodation Details/Profiles===========================================-->
  @if (enableDetailView) {
    <mat-grid-tile [colspan]="12" [rowspan]="1">
      <mat-card class="searchView">
        <mat-card-content class="search-view-container">
          <div class="details-search-container">
            <span class="title">Accommodation Details</span>
            <mat-form-field appearance="outline">
              <mat-label>Search Accommodation</mat-label>
              <input matInput (keyup)="filterTable($event)" #input>
              <mat-icon matPrefix>search</mat-icon>
            </mat-form-field>

            <div class="detail-button-group">
              <button mat-raised-button class="goto-form-btn" (click)="setView('form')"
                      [disabled]="!(enableAdd && hasInsertAuthority)">New
                <mat-icon>add</mat-icon>
              </button>
              <button mat-raised-button class="goto-records-btn" (click)="setView('records')"
                      [disabled]="!(enableGoToRecode)">Records
                <mat-icon>list</mat-icon>
              </button>
              <button mat-raised-button class="tbl-selection-edit-btn"
                      [disabled]="!(enableEdit && hasUpdateAuthority)"
                      (click)="loadAccommodationModifyView(selectedRow); clearTableSelection()">Edit
                <mat-icon matPrefix>edit</mat-icon>
              </button>
              <button mat-raised-button class="tbl-selection-clear-btn" (click)="clearTableSelection()">Clear
                <mat-icon matPrefix>clear</mat-icon>
              </button>
            </div>
          </div>
        </mat-card-content>
      </mat-card>
    </mat-grid-tile>

    <mat-grid-tile [colspan]="5" [rowspan]="10" class="searchTile">
      <mat-card>
        <mat-card-content>
          <mat-table [dataSource]="data">
            @for (column of columnsDetails; track columnsDetails; let i = $index) {
              <ng-container [matColumnDef]="column">
                <mat-header-cell *matHeaderCellDef> {{ headersDetails[i] }}</mat-header-cell>
                <mat-cell *matCellDef="let element">
                  {{ element[column] }}
                </mat-cell>
              </ng-container>
            }

            <mat-header-row *matHeaderRowDef="columnsDetails"></mat-header-row>
            <mat-row *matRowDef="let row; columns: columnsDetails;"
                     (click)="loadAccommodationDetailView(row); selectAccommodationRow(row)"
                     [ngClass]="{'selected-row': row === selectedRow}"></mat-row>
            <tr class="mat-row" *matNoDataRow>
              <td class="mat-cell" colspan="4">No data matching the filter "{{ input.value }}"</td>
            </tr>
          </mat-table>
          <mat-paginator class="profile-table-paginator" [length]="20" [pageSize]="5" [pageSizeOptions]="[3,5,10,20]"
                         showFirstLastButtons></mat-paginator>

        </mat-card-content>
      </mat-card>
    </mat-grid-tile>

    <mat-grid-tile [colspan]="7" [rowspan]="10" class="searchTile">
      <mat-card class="card-container">
        <mat-card-content>
          <div class="details-container">
            <app-detail-view
              [showDisplayColors]="true"
              [showDisplayMessage]="true"
              messageToDisplay="Select a row to display"
              [isEnablePrint]="true"
            ></app-detail-view>
          </div>
        </mat-card-content>
      </mat-card>
    </mat-grid-tile>
  }
  <!--===============================================================================================================-->

  @if (enableRecordView) {

    <!--=======================================Accommodation Add / Preview / Search=========================================-->

    <mat-grid-tile [colspan]="12" [rowspan]="1">
      <mat-card class="searchView">
        <mat-card-content class="search-view-container">
          <div class="search-container">
            <span class="title"><b>Accommodations</b></span>
            <div class="search-view-button-group">
              <button class="add-btn" mat-raised-button (click)="setView('form')"
                      [disabled]="!(enableAdd && hasInsertAuthority)">New
                <mat-icon>add</mat-icon>
              </button>
              <button class="accomm-view-btn" mat-raised-button (click)="setView('profiles')"
                      [disabled]="!(enableGoToView)">View
                <mat-icon>person</mat-icon>
              </button>
            </div>
            <form [formGroup]="serverSearchForm" class="searchForm">
              @if (isSearchFiledInput) {
                <mat-form-field appearance="outline" class="search-input">
                  <mat-label>Search Here</mat-label>
                  <input matInput formControlName="searchInput">
                  <mat-icon matSuffix>search</mat-icon>
                </mat-form-field>
              }

              @if (isSearchFiledSelect) {
                <mat-form-field appearance="outline" hidden="hidden" class="search-select">
                  <mat-label>Select search value</mat-label>
                  <mat-select formControlName="searchSelect">
                    <mat-option [value]="null">Not Selected</mat-option>
                    @for (searchSelectOption of searchSelectOptions; track searchSelectOptions) {
                      <mat-option
                        [value]="searchSelectOption.id">
                        {{
                          searchSelectOption.name ||
                          searchSelectOption?.employee.callingname
                        }}
                      </mat-option>
                    }
                  </mat-select>
                </mat-form-field>
              }

              @if (isSearchFiledDate) {
                <mat-form-field appearance="outline">
                  <mat-label>Select date / range</mat-label>
                  <mat-date-range-input
                    [rangePicker]="searchDates">
                    <input matStartDate placeholder="Start date" formControlName="searchStartDate">
                    <input matEndDate placeholder="End date" formControlName="searchEndDate">
                  </mat-date-range-input>
                  <mat-datepicker-toggle matIconSuffix [for]="searchDates"></mat-datepicker-toggle>
                  <mat-date-range-picker #searchDates></mat-date-range-picker>
                </mat-form-field>
              }

              <mat-form-field appearance="outline" class="filter-select">
                <mat-label>Filter by</mat-label>
                <mat-select formControlName="filterField"
                            (selectionChange)="resetServerSearchQueryParamFields() ; loadSearchSelectOptions()">
                  <mat-option [value]="null">Not Selected</mat-option>
                  @for (filterFiled of filterFields; track filterFields) {
                    <mat-option [value]="filterFiled">{{ filterFiled }}</mat-option>
                  }
                </mat-select>
                <mat-icon matSuffix>filter_alt</mat-icon>
              </mat-form-field>

              <div class="button-group">
                <button mat-raised-button class="search-btn" (click)="search()">
                  <mat-icon>search</mat-icon>
                </button>
                <button mat-raised-button class="clear-btn" (click)="clearSearch()">
                  <mat-icon>clear</mat-icon>
                </button>
              </div>
            </form>
          </div>
        </mat-card-content>
      </mat-card>
    </mat-grid-tile>

    <!--=============================================Accommodation View Table===============================================-->

    <mat-grid-tile [colspan]="12" [rowspan]="7" style="margin-top: -1px">
      <mat-card>
        <mat-card-content>
          <div class="table-header-section">
            <mat-form-field style="padding-top: 10px; width: 100%;" appearance="outline" class="search-input">
              <mat-label>Filter Here</mat-label>
              <input matInput (keyup)="filterTable($event)" #input>
              <mat-icon matSuffix style="color: black !important;">filter_list</mat-icon>
            </mat-form-field>
            <div class="loading">
              <img [src]="imageURL" alt="loading-gif">
            </div>
          </div>

          <mat-table [dataSource]="data">

            @for (column of columns; track columns; let i = $index) {
              <ng-container [matColumnDef]="column">
                <!-- Header Cell -->
                <mat-header-cell *matHeaderCellDef> {{ headers[i] }}</mat-header-cell>
                <!-- Normal Data Cells -->
                <mat-cell *matCellDef="let element">

                  @if (column === 'modify/view') {
                    <!-- Action Buttons -->
                    <div class="tbl-btn-container">
                      <button mat-icon-button class="modify-btn"
                              (click)="fillForm(element); loadAccommModifyView(element)"
                              [disabled]="!(hasUpdateAuthority)">
                        <mat-icon>border_color</mat-icon>
                      </button>
                      <button mat-icon-button class="view-btn" (click)="loadAccommodationDetailView(element)">
                        <mat-icon>remove_red_eye</mat-icon>
                      </button>
                    </div>
                  }
                  {{ element[column]?.name || element[column] }}
                </mat-cell>
              </ng-container>
            }

            <mat-header-row *matHeaderRowDef="columns"></mat-header-row>
            <mat-row *matRowDef="let row; columns: columns;" (click)="selectAccommodationRow(row)"
                     [ngClass]="{'selected-row': row === selectedAccommodationRow}"></mat-row>
            <tr class="mat-row" *matNoDataRow>
              <td class="mat-cell" colspan="4">No data matching the filter "{{ input.value }}"</td>
            </tr>

          </mat-table>

          <mat-paginator [length]="20" [pageSize]="5" [pageSizeOptions]="[3,5,10,20]"
                         showFirstLastButtons></mat-paginator>

        </mat-card-content>

      </mat-card>
    </mat-grid-tile>
  }

</mat-grid-list>
